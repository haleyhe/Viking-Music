<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.vikings.dao.mapper.DataImportMapper">
    <cache />
    
    <insert id="createArtist" parameterType="com.vikings.domain.Artist">
        INSERT IGNORE INTO Artists (
            artistId,
            name,
            bio
        ) VALUES (
            #{id},
            #{name},
            #{bio}
        );
    </insert>
    
    <insert id="createArtistGenres" parameterType="com.vikings.domain.Artist">
        INSERT IGNORE INTO ArtistGenres (
            artistId,
            genre
        ) VALUES
            <foreach item="genre" collection="genres" separator=",">
                (#{id}, #{genre})
            </foreach>
        ;
    </insert>
    
    <insert id="createAlbum" parameterType="com.vikings.domain.Album">
        INSERT IGNORE INTO Albums (
            albumId,
            name,
            releaseDate
        ) VALUES (
            #{id},
            #{name},
            #{releaseDate}
        );
    </insert>
    
    <insert id="createAlbumArtists" parameterType="com.vikings.domain.Album">
        INSERT IGNORE INTO AlbumArtists (
            albumId,
            artistId
        ) VALUES
            <foreach item="artist" collection="artists" separator=",">
                (#{id}, #{artist.id})
            </foreach>
        ;
    </insert>
    
    <insert id="createSong" parameterType="com.vikings.domain.Song">
        INSERT IGNORE INTO Songs (
            songId,
            name,
            duration,
            explicit,
            discNumber,
            trackNumber,
            lyrics
        ) VALUES (
            #{id},
            #{name},
            #{duration},
            #{explicit},
            #{discNumber},
            #{trackNumber},
            #{lyrics}
        );
    </insert>
    
    <insert id="createSongArtists" parameterType="com.vikings.domain.Song">
        INSERT IGNORE INTO SongArtists (
            songId,
            artistId
        ) VALUES
            <foreach item="artist" collection="artists" separator=",">
                (#{id}, #{artist.id})
            </foreach>
        ;
    </insert>
    
    <insert id="createSongAlbum" parameterType="com.vikings.domain.Song">
        INSERT IGNORE INTO AlbumSongs (
            songId,
            albumId
        ) VALUES (
            #{id},
            #{album.id}
        );
    </insert>

    <insert id="createAddress" parameterType="com.vikings.domain.Address">
        INSERT IGNORE INTO Addresses (
            street,
            city,
            state,
            zip
        ) VALUES (
            #{street},
            #{city},
            #{state},
            #{zip}
        )
    </insert>

    <insert id="createVenue" parameterType="com.vikings.domain.Venue">
        INSERT IGNORE INTO ConcertVenues (
            venueId,
            name,
            street,
            zip
        ) VALUES (
            #{id},
            #{name},
            #{address.street},
            #{address.zip}
        )
    </insert>

    <insert id="createConcert" parameterType="com.vikings.domain.Concert">
        INSERT IGNORE INTO Concerts (
            concertId,
            concertDate,
            venueId,
            ticketingUrl
        ) VALUES (
            #{id},
            #{date},
            #{venue.id},
            #{ticketingUrl}
        )
    </insert>

    <insert id="createConcertArtists" parameterType="com.vikings.domain.Concert">
        INSERT IGNORE INTO ConcertArtists (
            concertId,
            artistId
        ) VALUES
            <foreach item="artist" collection="artists" separator=",">
                (#{id}, #{artist.id})
            </foreach>
    </insert>
    
</mapper>
